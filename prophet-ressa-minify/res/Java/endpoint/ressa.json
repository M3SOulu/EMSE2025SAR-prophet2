[
    {
        "identifier": "ClassOrInterface",
        "pattern": ".*",
        "auxiliary_pattern": "#{pkg}",
        "subpatterns": [
            {
                "identifier": "Method",
                "pattern": "^main$",
                "auxiliary_pattern": "^void$",
                "subpatterns": [],
                "essential": true
            }
        ],
        "callback": "pkg_retriever.rn",
        "essential": true
    },
    {
        "identifier": "ClassOrInterface",
        "pattern": "#{controller}",
        "auxiliary_pattern": "#{package}",
        "subpatterns": [
            {
                "identifier": "Annotation",
                "pattern": "@RequestMapping",
                "auxiliary_pattern": "\"#{endpoint_url_base}\"",
                "subpatterns": [],
                "essential": true
            },
            {
                "identifier": "Method",
                "pattern": "#{endpoint_method}",
                "auxiliary_pattern": "#{return_type}",
                "subpatterns": [
                    {
                        "identifier": "Annotation",
                        "pattern": "@#{method_type}Mapping",
                        "auxiliary_pattern": "#{endpoint_url_part}",
                        "subpatterns": [
                            {
                                "identifier": "AnnotationValuePair",
                                "pattern": "path",
                                "auxiliary_pattern": "\"#{endpoint_url_part_path}\"",
                                "subpatterns": [],
                                "essential": false
                            },
                            {
                                "identifier": "AnnotationValuePair",
                                "pattern": "value",
                                "auxiliary_pattern": "\"#{endpoint_url_part_path}\"",
                                "subpatterns": [],
                                "essential": false
                            }
                        ],
                        "callback": "endpoint_url_part_path.rn",
                        "essential": true
                    }
                ],
                "callback": "controller.rn",
                "essential": true
            }
        ],
        "essential": true
    },
    {
        "identifier": "ClassOrInterface",
        "pattern": "#{service}",
        "auxiliary_pattern": "#{package}",
        "subpatterns": [
            {
                "identifier": "Annotation",
                "pattern": "@Service",
                "subpatterns": [],
                "essential": true
            },
            {
                "identifier": "Field",
                "pattern": "#{path_var_name}",
                "subpatterns": [
                    {
                        "identifier": "Literal",
                        "pattern": "(https?://.*):(\\d*)#{path_var_val}/?\"",
                        "subpatterns": [],
                        "callback": "path_var.rn",
                        "essential": false
                    }
                ],
                "essential": false
            },
            {
                "identifier": "Method",
                "pattern": "#{calling_method}",
                "subpatterns": [
                    {
                        "identifier": "CallExpr",
                        "pattern": "exchange",
                        "auxiliary_pattern": "#{somename}",
                        "subpatterns": [
                            {
                                "identifier": "Literal",
                                "transparent": true,
                                "pattern": "",
                                "auxiliary_pattern": "",
                                "subpatterns": [
                                    {
                                        "identifier": "Literal",
                                        "pattern": "(https?://.*):(\\d*)#{path_root}/?\"",
                                        "subpatterns": [],
                                        "callback": "path_root.rn",
                                        "essential": true
                                    },
                                    {
                                        "identifier": "Ident",
                                        "pattern": "#{path_root_ident}",
                                        "subpatterns": [],
                                        "callback": "path_root_ident.rn",
                                        "essential": true
                                    },
                                    {
                                        "identifier": "Ident",
                                        "pattern": "#{path_ident}",
                                        "subpatterns": [],
                                        "essential": false,
                                        "callback": "path_ident.rn"
                                    },
                                    {
                                        "identifier": "Literal",
                                        "pattern": "\"#{path_lit}\"",
                                        "subpatterns": [],
                                        "essential": false,
                                        "callback": "path_lit.rn"
                                    }
                                ],
                                "essential": true,
                                "callback": "path_lit_final.rn"
                            },
                            {
                                "identifier": "Ident",
                                "pattern": "#{method_ident}(^[A-Z]+$)",
                                "subpatterns": [],
                                "essential": true,
                                "callback": "callee.rn"
                            }
                        ],
                        "callback": "calling_method_final.rn",
                        "essential": false
                    }
                ],
                "essential": false
            }
        ],
        "essential": true
    }
]
